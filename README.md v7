# iOS Static Analysis Guide

![Xcode](https://img.shields.io/badge/Xcode-15.0+-blue.svg)
![Platform](https://img.shields.io/badge/platform-iOS%20%7C%20macOS-lightgrey.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

A comprehensive guide to using Xcode's static analyzer for identifying potential bugs, memory leaks, and logic errors in iOS/macOS projects. This guide covers local development workflows, CI/CD integration, and advanced configuration options.

## üìã Table of Contents

- [Features](#features)
- [Quick Start](#quick-start)
- [Installation](#installation)
- [Basic Usage](#basic-usage)
- [Advanced Configuration](#advanced-configuration)
- [CI/CD Integration](#cicd-integration)
- [Troubleshooting](#troubleshooting)
- [Best Practices](#best-practices)
- [Contributing](#contributing)
- [License](#license)

## üöÄ Features

- **Comprehensive Static Analysis** - Detect potential bugs before runtime
- **CI/CD Ready** - Seamless integration with GitHub Actions, Jenkins, and GitLab CI
- **Customizable Rules** - Configure analysis depth and warning levels
- **Multiple Output Formats** - HTML, PLIST, and console output
- **Team Collaboration** - Pre-commit hooks and quality gates
- **Performance Optimized** - Parallel analysis and caching support

## ‚ö° Quick Start

### Prerequisites

- Xcode 15.0 or later
- macOS 12.0 or later
- iOS 15.0+ target deployment

### Basic Analysis

```bash
# Clone this repository
git clone https://github.com/your-username/ios-static-analysis-guide.git
cd ios-static-analysis-guide

# Make the scripts executable
chmod +x scripts/*.sh

# Run basic analysis
./scripts/basic-analysis.sh
```

### One-Command Setup

```bash
# Run the setup script for your project
./scripts/setup-analysis.sh --project MyApp.xcodeproj --scheme MyApp
```

## üì¶ Installation

### Manual Setup

1. **Add analysis scripts to your project:**

```bash
# Copy analysis scripts to your project
cp -R scripts/ your-ios-project/
cp -R ci-config/ your-ios-project/
```

2. **Configure analysis for your project:**

```bash
cd your-ios-project
./scripts/setup-team-analysis.sh
```

### Using Swift Package Manager

Add this guide as a development dependency:

```swift
// Package.swift
dependencies: [
    .package(url: "https://github.com/your-username/ios-static-analysis-guide.git", from: "1.0.0")
]
```

## üõ†Ô∏è Basic Usage

### Local Development

```bash
# Basic analysis
./scripts/basic-analysis.sh

# Analysis with specific configuration
./scripts/advanced-analysis.sh --workspace MyApp.xcworkspace --scheme MyApp --configuration Debug

# Pre-commit analysis (add to .git/hooks/pre-commit)
./scripts/pre-commit-analysis.sh
```

### Common Commands

| Command | Purpose | Usage |
|---------|---------|--------|
| **Basic Analysis** | Run static analysis | `xcodebuild analyze -workspace MyApp.xcworkspace -scheme MyApp` |
| **With Configuration** | Specific build config | `xcodebuild analyze -workspace MyApp.xcworkspace -scheme MyApp -configuration Debug` |
| **Output to File** | Save results | `xcodebuild analyze ... CLANG_ANALYZER_OUTPUT_DIR="./results"` |
| **Verbose Mode** | Detailed output | `xcodebuild analyze ... CLANG_ANALYZER_VERBOSE=YES` |

### Integration with Xcode

1. **Add Build Phase Script:**

```bash
# In Xcode: Build Phases -> New Run Script Phase
"${SRCROOT}/scripts/xcode-build-phase-analysis.sh"
```

2. **Custom Scheme Configuration:**

- Duplicate your main scheme
- Add `analyze` action in Build section
- Set to run parallelly

## ‚öôÔ∏è Advanced Configuration

### Analysis Configuration File

Create `.static-analysis-config` in your project root:

```bash
# Analysis Configuration
PROJECT_WORKSPACE="MyApp.xcworkspace"
MAIN_SCHEME="MyApp"
TEST_SCHEME="MyAppTests"
MAX_ACCEPTABLE_ISSUES=10
OUTPUT_DIR="./analysis-results"
CLANG_ANALYZER_VERBOSE=YES
CLANG_ANALYZER_OUTPUT=plist-html
```

### Custom Analysis Rules

```bash
#!/bin/bash
# custom-rules-analysis.sh

# Enable specific analyzers
export CLANG_ANALYZER_SECURITY=YES
export CLANG_ANALYZER_SECURITY_INSECUREAPI=YES
export CLANG_ANALYZER_SECURITY_KEYCHAIN=YES

xcodebuild analyze \
    -workspace "$PROJECT_WORKSPACE" \
    -scheme "$MAIN_SCHEME" \
    -configuration Debug \
    CLANG_ANALYZER_CONFIGURATION="deep" \
    GCC_ANALYZER_WARNINGS=YES
```

### Multiple Scheme Analysis

```bash
#!/bin/bash
# multi-scheme-analysis.sh

SCHEMES=("MyApp" "MyAppTests" "MyAppUITests")
for SCHEME in "${SCHEMES[@]}"; do
    echo "üîç Analyzing: $SCHEME"
    xcodebuild analyze \
        -workspace MyApp.xcworkspace \
        -scheme "$SCHEME" \
        -configuration Debug \
        CLANG_ANALYZER_OUTPUT_DIR="./analysis/$SCHEME"
done
```

## üîÑ CI/CD Integration

### GitHub Actions

```yaml
# .github/workflows/static-analysis.yml
name: iOS Static Analysis

on: [push, pull_request]

jobs:
  analyze:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run Static Analysis
        run: |
          chmod +x ./scripts/ci-analysis.sh
          ./scripts/ci-analysis.sh
```

### Jenkins Pipeline

```groovy
// Jenkinsfile
pipeline {
    agent { label 'macos' }
    stages {
        stage('Static Analysis') {
            steps {
                sh './scripts/ci-analysis.sh --jenkins'
            }
        }
    }
}
```

### GitLab CI

```yaml
# .gitlab-ci.yml
static_analysis:
  image: xcode:15.0
  script:
    - ./scripts/ci-analysis.sh --gitlab
  artifacts:
    paths:
      - analysis-results/
```

## üêõ Troubleshooting

### Common Issues

| Issue | Solution |
|-------|----------|
| **Scheme not found** | Run `xcodebuild -list` to see available schemes |
| **Code signing errors** | Use `CODE_SIGNING_REQUIRED=NO` for analysis |
| **Simulator unavailable** | Check with `xcrun simctl list devices` |
| **Memory issues** | Increase stack size with `ulimit -S -n 2048` |

### Debug Script

```bash
# Run debug analysis
./scripts/debug-analysis.sh

# Check environment
./scripts/check-environment.sh
```

### Performance Optimization

```bash
# Enable derived data caching
xcodebuild analyze ... -derivedDataPath ./DerivedData

# Parallel analysis
xcodebuild analyze ... -parallelizeTargets

# Disable indexing for analysis
COMPILER_INDEX_STORE_ENABLE=NO
```

## üìä Best Practices

### 1. Code Quality Gates

```bash
#!/bin/bash
# quality-gate.sh

MAX_ISSUES=5
./scripts/run-analysis.sh

ISSUE_COUNT=$(find ./analysis-results -name "*.plist" | wc -l)

if [ $ISSUE_COUNT -gt $MAX_ISSUES ]; then
    echo "‚ùå Quality gate failed: $ISSUE_COUNT issues"
    exit 1
fi
echo "‚úÖ Quality gate passed"
```

### 2. Regular Analysis

```bash
# Add to crontab for daily analysis
0 2 * * * /path/to/your/project/scripts/daily-analysis.sh
```

### 3. Team Collaboration

```bash
# Setup team analysis
./scripts/setup-team-analysis.sh

# Create pre-push hook
cp scripts/pre-push-analysis.sh .git/hooks/pre-push
```

### 4. Reporting

Generate comprehensive reports:

```bash
./scripts/generate-report.sh --format html
./scripts/generate-report.sh --format json
./scripts/generate-report.sh --format markdown
```

## ü§ù Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details.

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

### Development Setup

```bash
git clone https://github.com/your-username/ios-static-analysis-guide.git
cd ios-static-analysis-guide
./scripts/setup-development.sh
```

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üîó Resources

- [Official Xcode Documentation](https://developer.apple.com/documentation/xcode)
- [CLANG Static Analyzer](https://clang-analyzer.llvm.org/)
- [Apple's Static Analysis Guide](https://developer.apple.com/documentation/xcode/analyzing-your-code-using-the-static-analyzer)

## üìû Support

- **Issues**: [GitHub Issues](https://github.com/your-username/ios-static-analysis-guide/issues)
- **Discussions**: [GitHub Discussions](https://github.com/your-username/ios-static-analysis-guide/discussions)
- **Email**: support@yourdomain.com

## üèÜ Acknowledgments

- Apple Developer Tools team
- CLANG/LLVM community
- Contributors and testers

---

<div align="center">
  
**Made with ‚ù§Ô∏è for the iOS developer community**

[‚¨Ü Back to Top](#ios-static-analysis-guide)

</div>
